{% extends "base.html" %}

{% block content %}
<div class="header">
    <div style="width: 100%; text-align: center; margin-top: 3rem;">
        <h1 style="font-size: 3rem; margin-bottom: 0.5rem;">Knowledge Base ğŸ§ </h1>
        <p style="color: var(--text-muted); font-size: 1.1rem;">Modern Search for Your Resources</p>
    </div>
</div>

<div class="kb-modern-container">
    <div class="kb-search-wrapper">
        <div class="kb-search-box-modern">
            <span class="search-icon-modern">ğŸ”</span>
            <input type="text" id="kbSearchInput" placeholder="How can we help you today?" onkeyup="searchKB()">
            <button class="btn btn-modern" onclick="openKBModal()">â• New</button>
        </div>
    </div>

    <div id="kbSearchResults" class="kb-modern-results">
        <!-- Google-style results go here -->
    </div>
</div>

<!-- Result Detail Modal -->
<div id="kbResultDetailModal" class="modal">
    <div class="modal-content result-frame-modal">
        <span class="close" onclick="closeKBResultModal()">&times;</span>
        <div id="kbResultDetailContent">
            <h2 id="kbResultDetailTitle" style="color: var(--primary-color);"></h2>
            <div class="kb-meta-info" id="kbResultDetailDate"></div>
            <button class="btn btn-secondary" onclick="copyKBContent(event)"
                style="margin-top: 1rem; display: inline-flex; align-items: center; gap: 8px;">
                ğŸ“‹ Copy to Clipboard
            </button>
            <hr style="margin: 1.5rem 0; opacity: 0.1;">
            <div id="kbResultDetailData" class="kb-detail-data"></div>
            <div id="kbResultDetailUrl" style="margin-top: 2rem;">
                <a id="kbResultDetailLink" href="#" target="_blank" class="btn btn-secondary">Visit Resource ğŸ”—</a>
            </div>
        </div>
    </div>
</div>

<!-- Modal for KB Creation/Edit -->
<div id="kbModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeKBModal()">&times;</span>
        <h2 id="kbModalTitle">New Knowledge Base</h2>
        <form id="kbForm" style="margin-top: 20px;">
            <input type="hidden" id="kbId">
            <div class="input-group">
                <input type="text" id="kbTitle" placeholder="Title" required>
            </div>
            <div class="input-group">
                <label
                    style="display: block; margin-bottom: 0.5rem; color: var(--text-color); font-weight: 500;">Content
                    (supports rich text formatting)</label>
                <div id="kbData" contenteditable="true" class="rich-text-editor"
                    data-placeholder="Paste or type your content here... (supports bold, italic, lists, etc.)"
                    style="min-height: 200px; max-height: 400px; overflow-y: auto; padding: 1rem; border: 2px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--text-color); outline: none; line-height: 1.6;">
                </div>
            </div>
            <div class="input-group">
                <input type="url" id="kbUrl" placeholder="URL (optional)">
            </div>
            <button type="submit" class="btn">Save Knowledge Base</button>
        </form>
    </div>
</div>
{% endblock %}